import{e as O,C as z,M as j,D as G,x as L,v as N,ad as V,o as g,c as w,F as A,l as U,U as _,h as Y,$ as q,d as H,t as I}from"./BMKAczWz.js";function J(l,o){let u;return(...i)=>{u!==void 0&&clearTimeout(u),u=setTimeout(()=>l(...i),o)}}function K({columns:l,columnWidth:o,emit:u,gap:i,items:d,maxColumns:m,minColumns:f,nextTick:a,onBeforeUnmount:T,onMounted:C,rtl:s,scrollContainer:r,ssrColumns:v,vue:h,wall:x,watch:B}){function R(n,e,t,c){const p=b(t);return c+e+p<=n?R(n,e,t+1,c+e+p):t}function b(n){const e=Array.isArray(o.value)?o.value:[o.value];return e[n%e.length]}function D(){const n=R(x.value.getBoundingClientRect().width,i.value,0,-i.value),e=F(E(n));return e>0?e:1}function E(n){const e=m==null?void 0:m.value;return e&&n>e?e:n}function F(n){const e=f==null?void 0:f.value;return e&&n<e?e:n}function M(n){return Array.from({length:n}).map(()=>[])}if(v.value>0){const n=M(v.value);d.value.forEach((e,t)=>n[t%v.value].push(t)),l.value=n}let S=0;async function $(n,e){if(n>=d.value.length||(await a(),S!==e))return;const t=[...x.value.children];s.value&&t.reverse();const c=t.reduce((p,W)=>W.getBoundingClientRect().height<p.getBoundingClientRect().height?W:p);l.value[+c.dataset.index].push(n),await $(n+1,e)}async function y(n=!1){const e=D();if(l.value.length===e&&!n){u(h===2?"redraw-skip":"redrawSkip");return}l.value=M(e);const t=r==null?void 0:r.value,c=t?t.scrollTop:window.scrollY;await $(0,++S),t?t.scrollBy({top:c-t.scrollTop}):window.scrollTo({top:c}),u("redraw")}const k=typeof ResizeObserver>"u"?void 0:new ResizeObserver(J(()=>y()));return C(()=>{y(),k==null||k.observe(x.value)}),T(()=>k==null?void 0:k.unobserve(x.value)),B([d,s],()=>y(!0)),B([o,i,f,m],()=>y()),{getColumnWidthTarget:b}}const P=["data-index"],Q=O({__name:"masonry-wall",props:{columnWidth:{default:400},items:{},gap:{default:0},rtl:{type:Boolean,default:!1},ssrColumns:{default:0},scrollContainer:{default:null},minColumns:{default:1},maxColumns:{},keyMapper:{}},emits:["redraw","redrawSkip"],setup(l,{emit:o}){const u=l,i=o,d=z([]),m=z(),{getColumnWidthTarget:f}=K({columns:d,emit:i,nextTick:j,onBeforeUnmount:G,onMounted:L,vue:3,wall:m,watch:N,...V(u)});return(a,T)=>(g(),w("div",{ref_key:"wall",ref:m,class:"masonry-wall",style:_({display:"flex",gap:`${a.gap}px`})},[(g(!0),w(A,null,U(d.value,(C,s)=>(g(),w("div",{key:s,class:"masonry-column","data-index":s,style:_({display:"flex","flex-basis":`${Y(f)(s)}px`,"flex-direction":"column","flex-grow":1,gap:`${a.gap}px`,height:["-webkit-max-content","-moz-max-content","max-content"],"min-width":0})},[(g(!0),w(A,null,U(C,(r,v)=>{var h;return g(),w("div",{key:((h=a.keyMapper)==null?void 0:h.call(a,a.items[r],s,v,r))??r,class:"masonry-item"},[q(a.$slots,"default",{item:a.items[r],column:s,row:v,index:r},()=>[H(I(a.items[r]),1)])])}),128))],12,P))),128))],4))}}),Z=(()=>{const l=Q;return l.install=o=>{o.component("MasonryWall",l)},l})();export{Z as R};
