import{e as D,r as z,s as O,R as G,K as J,J as K,an as L,o as g,c as w,F as A,C as _,a4 as E,j as N,a9 as V,d as Y,t as q}from"./C501vlBE.js";function H(l,a){let u;return(...i)=>{u!==void 0&&clearTimeout(u),u=setTimeout(()=>l(...i),a)}}function I({columns:l,columnWidth:a,emit:u,gap:i,items:m,maxColumns:d,minColumns:f,nextTick:o,onBeforeUnmount:T,onMounted:C,rtl:s,scrollContainer:r,ssrColumns:v,vue:y,wall:h,watch:B}){function R(n,e,t,c){const p=b(t);return c+e+p<=n?R(n,e,t+1,c+e+p):t}function b(n){const e=Array.isArray(a.value)?a.value:[a.value];return e[n%e.length]}function F(){const n=R(h.value.getBoundingClientRect().width,i.value,0,-i.value),e=j(U(n));return e>0?e:1}function U(n){const e=d==null?void 0:d.value;return e&&n>e?e:n}function j(n){const e=f==null?void 0:f.value;return e&&n<e?e:n}function S(n){return Array.from({length:n}).map(()=>[])}if(v.value>0){const n=S(v.value);m.value.forEach((e,t)=>n[t%v.value].push(t)),l.value=n}let M=0;async function W(n,e){if(n>=m.value.length||(await o(),M!==e))return;const t=[...h.value.children];s.value&&t.reverse();const c=t.reduce((p,$)=>$.getBoundingClientRect().height<p.getBoundingClientRect().height?$:p);l.value[+c.dataset.index].push(n),await W(n+1,e)}async function x(n=!1){const e=F();if(l.value.length===e&&!n){u(y===2?"redraw-skip":"redrawSkip");return}l.value=S(e);const t=r==null?void 0:r.value,c=t?t.scrollTop:window.scrollY;await W(0,++M),t?t.scrollBy({top:c-t.scrollTop}):window.scrollTo({top:c}),u("redraw")}const k=typeof ResizeObserver>"u"?void 0:new ResizeObserver(H(()=>x()));return C(()=>{x(),k==null||k.observe(h.value)}),T(()=>k==null?void 0:k.unobserve(h.value)),B([m,s],()=>x(!0)),B([a,i,f,d],()=>x()),{getColumnWidthTarget:b}}const P=["data-index"],Q=D({__name:"masonry-wall",props:{columnWidth:{default:400},items:{},gap:{default:0},rtl:{type:Boolean,default:!1},ssrColumns:{default:0},scrollContainer:{default:null},minColumns:{default:1},maxColumns:{},keyMapper:{}},emits:["redraw","redrawSkip"],setup(l,{emit:a}){const u=l,i=a,m=z([]),d=z(),{getColumnWidthTarget:f}=I({columns:m,emit:i,nextTick:O,onBeforeUnmount:G,onMounted:J,vue:3,wall:d,watch:K,...L(u)});return(o,T)=>(g(),w("div",{ref_key:"wall",ref:d,class:"masonry-wall",style:E({display:"flex",gap:`${o.gap}px`})},[(g(!0),w(A,null,_(m.value,(C,s)=>(g(),w("div",{key:s,class:"masonry-column","data-index":s,style:E({display:"flex","flex-basis":`${N(f)(s)}px`,"flex-direction":"column","flex-grow":1,gap:`${o.gap}px`,height:["-webkit-max-content","-moz-max-content","max-content"],"min-width":0})},[(g(!0),w(A,null,_(C,(r,v)=>{var y;return g(),w("div",{key:((y=o.keyMapper)==null?void 0:y.call(o,o.items[r],s,v,r))??r,class:"masonry-item"},[V(o.$slots,"default",{item:o.items[r],column:s,row:v,index:r},()=>[Y(q(o.items[r]),1)])])}),128))],12,P))),128))],4))}}),Z=(()=>{const l=Q;return l.install=a=>{a.component("MasonryWall",l)},l})();export{Z as R};
